<!--
 * Copyright (c) 2013 - 2014, b3devs@gmail.com
 *
 * Licensed under the Common Development and Distribution License (the "License"); you may not use this
 * source code or associated Google document except in compliance with the License. You may obtain a
 * copy of the License at
 *
 * http://opensource.org/licenses/cddl1.php
 *
 * Any modifications to this Software that You distribute or otherwise make available in Executable
 * form must also be made available in Source Code form and that Source Code form must be distributed
 * only under the terms of this License.
 *
 * Unless required by applicable law or agreed to in writing, software distributed under the License
 * is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express
 * or implied. See the License for the specific language governing permissions and limitations under
 * the License.
-->

<style>
.msg_area
{
  font-family: Calibri;
  font-size: Medium;
  width: 100%;
  height: 125px;
  overflow: auto;
}
</style>
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>

<?
var paramsJson = Utils.getPrivateCache().get(Const.CACHE_RECONCILE_PARAMS);
Debug.log("paramsJson: %s", paramsJson);
var reconcileParams = JSON.parse(paramsJson);

Utils.getPrivateCache().remove(Const.CACHE_RECONCILE_PARAMS);
?>
<div class="msg_area">
<p>Account "<?!= reconcileParams.account ?>" was successfully reconciled.</p>
<p>Would you like to save your reconciled transactions to Mint now?</p>
</div>
<div>
<p style="text-align: center; margin-bottom: 0;">
<input type="button" id="yes_button" value="Yes" onclick="submitChanges();" style="height: 30px; width: 75px;"/>
&nbsp;&nbsp;
<input type="button" id="cancel_button" value="Cancel" onclick="closeWindow()" style="height: 30px; width: 75px;"/>
</p>
</div>
<script type="text/javascript">
function submitChanges() {
  try
  {
  <? Debug.log("Calling 'MojitoLib.Reconcile.submitReconciledTransactions'") ?>
    var args = <?!= paramsJson ?>;

    document.getElementById("yes_button").disabled = true;

    google.script.run.withSuccessHandler(closeWindow).invokeFunction("MojitoLib.Reconcile.submitReconciledTransactions", args);
  }
  catch (e)
  {
    alert(e.toString());
  }
}

function closeWindow() {
  google.script.host.close();
}

</script>
